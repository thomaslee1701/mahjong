<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mahmahmahjong</title>
</head>
<body style="background-color:darkgrey">
    I remember so little html it's not even funny.

    <div id="hand">
        <p>Hand is here:</p>
    </div>

    <input type="text" id='queryBox' placeholder="Enter query here">
    <button onclick="sendQuery()">Send!</button>

    <script>
        const ws = new WebSocket("ws://localhost:8082");

        let id = window.crypto.getRandomValues(new Uint32Array(1))[0];

        ws.addEventListener('open', () => {
            ws.send(id);
        });

        ws.addEventListener('message', ({data}) => {
            if (data.split(":")[0] == 'HAND') { // Display the hand on the page
                let tag = document.createElement("div");
                hand = data.split(":")[1].split(' '); // hand is the actual hand array
                for (let i = 0; i < hand.length; i += 1) {
                    let img = new Image(width=50, height=100);
                    img.border='5px solid transparent';
                    img.src = `./images/${hand[i]}.png`;
                    tag.appendChild(img);
                }
                let element = document.getElementById("hand");
                element.appendChild(tag);
            } else if (data.split(":")[0] == 'YOURTURN') {
                if (data.split(":")[1] == id) {
                    ws.send(`QUERY:draw tile;${id}`);
                }
            } else {
                console.log(data);
            }
        })

        function sendQuery() {
            ws.send(`QUERY:${document.getElementById("queryBox").value};${id}`);
            console.log('query sent!');
            document.getElementById('queryBox').value = '';
        }
        
        
    </script>
</body>
</html>